<workdayEntityConfigurationTemplate>
    <scenario name="msdyn_HRWorkdayHCMEmployeeGetDependents">
        <apiRequests>
            <apiRequest>
                <authType>User</authType>
                <endpoint>
                    <request>Template_GetDependentsRequest</request>
                    <serviceName>Human_Resources</serviceName>
                    <version>v42.0</version>
                </endpoint>
                <responseProperties>
                    <!-- ONLY extract data from Related_Person nodes that have a Dependent child -->
                    <!-- This ensures all arrays are aligned (only actual dependents) -->
                    
                    <!-- Dependent ID -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Dependent']/*[local-name()='Dependent_Reference']/*[local-name()='ID' and @*[local-name()='type']='Dependent_ID']/text()</extractPath>
                        <key>DependentID</key>
                    </property>
                    <!-- Dependent WID -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Dependent']/*[local-name()='Dependent_Reference']/*[local-name()='ID' and @*[local-name()='type']='WID']/text()</extractPath>
                        <key>DependentWID</key>
                    </property>
                    <!-- Person WID (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Person_Reference']/*[local-name()='ID' and @*[local-name()='type']='WID']/text()</extractPath>
                        <key>PersonWID</key>
                    </property>
                    <!-- Full Name (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Personal_Data']/*[local-name()='Name_Data']/*[local-name()='Legal_Name_Data']/*[local-name()='Name_Detail_Data']/@*[local-name()='Formatted_Name']</extractPath>
                        <key>FullName</key>
                    </property>
                    <!-- First Name (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Personal_Data']/*[local-name()='Name_Data']/*[local-name()='Legal_Name_Data']/*[local-name()='Name_Detail_Data']/*[local-name()='First_Name']/text()</extractPath>
                        <key>FirstName</key>
                    </property>
                    <!-- Last Name (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Personal_Data']/*[local-name()='Name_Data']/*[local-name()='Legal_Name_Data']/*[local-name()='Name_Detail_Data']/*[local-name()='Last_Name']/text()</extractPath>
                        <key>LastName</key>
                    </property>
                    <!-- Date of Birth (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Personal_Data']/*[local-name()='Personal_Information_Data']/*[local-name()='Birth_Date']/text()</extractPath>
                        <key>DateOfBirth</key>
                    </property>
                    <!-- Gender (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Personal_Data']/*[local-name()='Personal_Information_Data']//*[local-name()='Gender_Reference']/*[local-name()='ID' and @*[local-name()='type']='Gender_Code']/text()</extractPath>
                        <key>Gender</key>
                    </property>
                    <!-- Relationship Type ID (only for dependents) -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Related_Person_Relationship_Reference']/*[local-name()='ID' and @*[local-name()='type']='Related_Person_Relationship_ID']/text()</extractPath>
                        <key>RelationshipTypeID</key>
                    </property>
                    <!-- Full-time Student flag -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Dependent']/*[local-name()='Dependent_Data']/*[local-name()='Full-time_Student']/text()</extractPath>
                        <key>IsFullTimeStudent</key>
                    </property>
                    <!-- Disabled flag -->
                    <property>
                        <extractPath>//*[local-name()='Related_Person_Data']/*[local-name()='Related_Person'][*[local-name()='Dependent']]/*[local-name()='Dependent']/*[local-name()='Dependent_Data']/*[local-name()='Disabled']/text()</extractPath>
                        <key>IsDisabled</key>
                    </property>
                </responseProperties>
            </apiRequest>
        </apiRequests>
    </scenario>
    <requestTemplates>
        <requestTemplate name="Template_GetDependentsRequest">
            <bsvc:Get_Workers_Request xmlns:bsvc="urn:com.workday/bsvc" bsvc:version="v42.0">
                <bsvc:Request_References bsvc:Skip_Non_Existing_Instances="false" bsvc:Ignore_Invalid_References="true">
                    <bsvc:Worker_Reference bsvc:Descriptor="Employee_ID">
                        <bsvc:ID bsvc:type="Employee_ID">{Employee_ID}</bsvc:ID>
                    </bsvc:Worker_Reference>
                </bsvc:Request_References>
                <bsvc:Response_Filter>
                    <bsvc:As_Of_Effective_Date>{As_Of_Effective_Date}</bsvc:As_Of_Effective_Date>
                </bsvc:Response_Filter>
                <bsvc:Response_Group>
                    <bsvc:Include_Reference>true</bsvc:Include_Reference>
                    <bsvc:Include_Personal_Information>false</bsvc:Include_Personal_Information>
                    <bsvc:Include_Employment_Information>false</bsvc:Include_Employment_Information>
                    <bsvc:Include_Organizations>false</bsvc:Include_Organizations>
                    <bsvc:Include_Roles>false</bsvc:Include_Roles>
                    <bsvc:Include_Management_Chain_Data>false</bsvc:Include_Management_Chain_Data>
                    <bsvc:Include_Benefit_Enrollments>false</bsvc:Include_Benefit_Enrollments>
                    <bsvc:Include_Benefit_Eligibility>false</bsvc:Include_Benefit_Eligibility>
                    <bsvc:Include_Related_Persons>true</bsvc:Include_Related_Persons>
                    <bsvc:Include_Qualifications>false</bsvc:Include_Qualifications>
                    <bsvc:Include_Photo>false</bsvc:Include_Photo>
                    <bsvc:Include_Worker_Documents>false</bsvc:Include_Worker_Documents>
                    <bsvc:Include_Transaction_Log_Data>false</bsvc:Include_Transaction_Log_Data>
                    <bsvc:Include_User_Account>false</bsvc:Include_User_Account>
                </bsvc:Response_Group>
            </bsvc:Get_Workers_Request>
        </requestTemplate>
    </requestTemplates>
</workdayEntityConfigurationTemplate>
